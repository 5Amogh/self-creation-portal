<div class="main flex">
    <div class="w-full">
        <div color="secondary" class="border-b px-10 py-2">
            <span>{{"SUBTASKS_AND_RESOURCES" | translate}}</span>
        </div>
        <div class="px-10 my-5">
            <p>{{"SUBTASKS_AND_RESOURCES_DESCRIPTION" | translate}}</p>
        </div>
        <div class="px-10 py-2">
            @for(item of taskData; track item; let i = $index) {
            <div>
                <p class="text-lg">{{item.header}}</p>
                <mat-card>
                    <div class="flex flex-row gap-15">
                        @for(button of item.buttons; track button) {
                        <div>
                            <mat-card-content class="cursor-pointer">
                                <div [class.disabled]="button.disable" (click)="!button.disable && onAction(button.label, i)" class="flex items-center text-primary">
                                    <mat-icon>add_circle</mat-icon><span class="px-2">{{button.label}}</span></div>
                                @if (button.label === 'Add subtask(s)') {
                                <form [formGroup]="item.subTasks" (ngSubmit)="onSubtasks(item.subTasks, i)">
                                    <div formArrayName="subtasks" class="flex flex-col gap-2">
                                        @for( control of item.subTasks.get('subtasks').controls;track control; let j =
                                        $index) {
                                        <div class="flex items-center space-x-2">
                                            <input class="border border-gray-300 rounded px-2 py-1 text-gray-500" type="text" placeholder="Set a meeting with a teacher">
                                            <mat-icon class="cursor-pointer"
                                                (click)="onDeleteSubtask(i, j)" color="primary">delete</mat-icon>
                                          </div>
                                        }
                                    </div>
                                </form>
                                }
                                @if (button.label === 'Add learning resource(s)' && item.resources){
                                <div class="flex flex-col gap-2">
                                    @for(resource of item.resources;track resource;let j= $index){
                                        <div class="flex justify-between items-center p-2 bg-gray-100 rounded mb-2">
                                            <section class="flex items-center gap-2">
                                                <mat-icon class="text-xl">videocam_off</mat-icon>
                                                <p>{{resource.name}}</p>
                                            </section>
                                            <mat-icon (click)="deleteResource(i, j)" class="cursor-pointer text-xl">cancel</mat-icon>
                                        </div>
                                    }
                                </div>
                                }
                            </mat-card-content>
                        </div>
                        }
                    </div>
                </mat-card>
            </div>
            }
        </div>
    </div>
</div>